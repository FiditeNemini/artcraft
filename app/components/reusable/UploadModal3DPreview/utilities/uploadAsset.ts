import { MediaUploadApi } from "~/Classes/ApiManager";
import { FilterEngineCategories, MediaFileAnimationType } from "~/enums";
import { getFileExtension } from "~/utilities";
import { v4 as uuidv4 } from "uuid";

export const uploadAsset = async ({
  file,
  title,
  animationType,
}: {
  file: File;
  title: string;
  animationType?: MediaFileAnimationType;
}) => {
  const mediaUploadApi = new MediaUploadApi();
  const fileExtension = getFileExtension(file);
  const assetReponse = await (async () => {
    switch (fileExtension) {
      case ".zip":
        return mediaUploadApi.UploadPmx({
          file: file,
          fileName: file.name,
          engine_category: FilterEngineCategories.CHARACTER,
          maybe_title: title,
          maybe_animation_type: animationType,
          uuid: uuidv4(),
        });
      case ".png":
      case ".gif":
      case ".jpg":
      case ".jpeg":
        return mediaUploadApi.UploadNewEngineAsset({
          file: file,
          fileName: file.name,
          engine_category: FilterEngineCategories.IMAGE_PLANE,
          maybe_animation_type: animationType,
          maybe_title: title,
          uuid: uuidv4(),
        });
      default:
        return mediaUploadApi.UploadNewEngineAsset({
          file: file,
          fileName: file.name,
          engine_category: FilterEngineCategories.OBJECT,
          maybe_animation_type: animationType,
          maybe_title: title,
          uuid: uuidv4(),
        });
    }
  })();

  return assetReponse;
};
